<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">


<!-- This is the param set for sdsave -->

<task type="function" name="sdsave" startup="false" category="single dish">

  <shortdescription>ASAP SD task: save the sd spectra in various format</shortdescription>

  <description>
        ASAP SD task (based on the ALMATST5 recommendations):
        save the sd spectra in various format

        Task Version 2008-01-29 TT
</description>

  <input>

    <param type="string" name="sdfile"  mustexist="true">
    <description>name of input SD dataset</description>
    <value></value>
    </param>

    <param type="any" name="antenna">
            <description>antenna name or id (only effective for MS input)</description>
            <any type="variant" limittype="string int"/>
            <value type="int">0</value>
    </param> 

    <param type="intArray" name="rowlist">
	    <description>list of row numbers to process (e.g. [0,2,4,6])</description>
	    <value></value>
    </param>

    <param type="intArray" name="scanlist">
	    <description>list of scan to process (e.g. [20,21,22,23])</description>
	    <value></value>
    </param>

    <param type="string" name="field">
            <description>string for selection by source name</description>
            <value></value>
    </param>

    <param type="intArray" name="iflist">
            <description>list of IF ids to select (e.g. [0,1])</description>
            <value></value>
    </param>

    <param type="intArray" name="pollist">
            <description>list of polarization ids to select (e.g. [0,1])</description>
            <value></value>
    </param>

    <param type="bool" name="scanaverage">
            <description>average integs within scans (True,False) </description>
            <value>False</value>
    </param>

    <param type="bool" name="timeaverage">
            <description>average scans over time (True,False)</description>
            <value>False</value>
    </param>

    <param type="string" name="tweight" subparam="true">
            <description>weighting for time averaging</description>
            <value>none</value>
            <allowed kind="enum">
            <value>none</value>
            <value>var</value>
            <value>tsys</value>
            <value>tint</value>
            <value>tintsys</value>
            <value>median</value>
            </allowed>
    </param>

    <param type="bool" name="polaverage">
            <description>average over polarizations (True,False)</description>
            <value>False</value>
    </param>

    <param type="string" name="pweight" subparam="true">
            <value>none</value>
            <allowed kind="enum">
            <value>none</value>
            <value>var</value>
            <value>tsys</value>
            </allowed>
    </param>

    <param type="string" name="outfile">
	    <description>output file name</description>
	    <value></value>
    </param>

    <param type="string" name="outform">
	    <description>output file format (ASCII,MS2,SDFITS,ASAP)</description>
	    <value>ASAP</value>
	    <allowed kind="enum">
	    <value>ASCII</value>
	    <value>MS2</value>
	    <value>SDFITS</value>
	    <value>ASAP</value>
	    </allowed>
    </param>

    <param type="bool" name="overwrite">
	    <description>overwrite the output file if already exists</description>
	    <value>False</value>
    </param>

    <constraints>
            <when param="timeaverage">                
                 <equals type="bool" value="False"/>
                 <equals type="bool" value="True">
                        <default param="tweight"><value type='string'>none</value></default>
                 </equals>
            </when>
            <when param="polaverage">
                 <equals type="bool" value="False"/>
                 <equals type="bool" value="True">
                        <default param="pweight"><value type='string'>none</value></default>
                 </equals>
            </when>
    </constraints>

    </input>

  <returns type="void"/>

  <example>
  Keyword arguments:
        sdfile -- name of input SD dataset
        antenna -- antenna name or id (only effective for MS input). 
        rowlist -- list of row numbers to process
                default: [] (use all rows)
                example: [0,2,4,6]
                         For expert users only!
                         this selection is applied first, and then 
                         followed by the selection with scans, fields, 
                         ifs, and polarizations. 
        scanlist -- list of to process
                default: [] (use all scans)
                example: [21,22,23,24]
                         this selection is in addition to field,
                         iflist, and pollist
        field -- selection string for selecting scans by name
                default: '' (no name selection)
                example: 'FLS3a*'
                         this selection is in addition to scanlist,
                         iflist, and pollist
        iflist -- list of IF id numbers to select
                default: [] (use all IFs)
                example: [15]
                         this selection is in addition to scanlist,
                         field, and pollist
        pollist -- list of polarization id numbers to select
                default: [] (use all polarizations)
                example: [1]
                         this selection is in addition to scanlist,
                         field, and iflist
        scanaverage --  average integrations within scans
                options: (bool) True,False
                default: False
                example: if True, average integrations before it is saved
        timeaverage -- average times for multiple scan cycles
                options: (bool) True,False
                default: False
                &gt;&gt;&gt;timeaverage expandable parameter
                 tweight -- weighting for time average
                         options: 'none'
                                  'var'   (1/var(spec) weighted)
                                  'tsys'  (1/Tsys**2 weighted)
                                  'tint'  (integration time weighted)
                                  'tintsys'  (Tint/Tsys**2)
                                  'median'  ( median averaging)
                         default: 'none'

        polaverage -- average polarizations
                options: (bool) True,False
                default: False
                &gt;&gt;&gt;polaverage expandable parameter
                 pweight -- weighting for polarization average
                         options: 'none'
                                  'var'  (1/var(spec) weighted)
                                  'tsys' (1/Tsys**2 weighted)
        outfile -- name of output dataset
                default: '' 
        outform -- output data format
                default: 'ASAP'
                Options: 'ASAP', 'MS2', 'SDFITS', 'ASCII'
        overwrite -- overwrite the output file if already exists
                options: (bool) True,False
                default: False
                WARNING: if outform='ASCII', this parameter is ignored


        DESCRIPTION:

        Task sdsave writes the single dish data to a disk file in 
        specified format (ASAP, MS2, SDFITS, ASCII). It is possible to 
        save the subset of the data by selecting row numbers, scan numbers, 
        IF ids, polarization ids and field names. The ASAP (scantable) format 
        is recommended for further analysis using Sd tool. For further 
        imaging using imager, save the data to the Measurement Set (MS2).

        WARNING for the GBT raw SDFITS format data as input:
        Currently, all SDtasks cannot handle GBT raw SDFITS format data
        (in which the data are stored in multiple tables within SDFITS).
        It may be still possible to reduce GBT data after some
        preprocessing (outside CASA) of the raw SDFITS to a SDFITS with
        a single data table or to other data formats handled by SDtasks.

  </example>

</task>

</casaxml>
