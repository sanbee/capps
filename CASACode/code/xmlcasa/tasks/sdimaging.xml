<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">


<!-- This is the param set for sdimaging -->

<task type="function" name="sdimaging" startup="false" category="single dish">

  <shortdescription>SD task: imaging for total power and spectral data</shortdescription>

  <description>SD task for imaging both total power and spectral data

        Task Version 2009-07-08 TN
</description>

  <input>
    <param type="string" name="sdfile"  mustexist="true">
    <description>name of input SD dataset(only MS is allowed for this task)</description>
    <value></value>
    </param>

    <param type="string" name="specunit">
	    <description>units for spectral axis (channel,km/s,GHz)</description>
	    <value></value>
	    <allowed kind="enum">
                <value></value>
 	        <value>channel</value>
 	        <value>km/s</value>
	        <value>GHz</value>
	        <value>MHz</value>
	        <value>kHz</value>
	        <value>Hz</value>
            </allowed>
    </param>

    <param type="any" name="restfreq" subparam="true">
            <description>rest frequency</description>
            <any type="variant" limittype="string double"/>
            <value type="string"/>
    </param>

    <param type="intArray" name="scanlist">
	    <description>list of scans to use (e.g. [1,2,3,4])</description>
	    <value></value>
    </param>

    <param type="any" name="field">
	    <description>string for selection by source name</description>
	    <any type="variant" limittype="string int"/>
            <value type="int">0</value>
    </param>

    <param type="int" name="spw">
	    <description>spectral window id for imaging</description>
	    <value>0</value>
    </param>

    <param type="any" name="antenna">
            <description>antenna name(s) or id(s)</description>
            <any type="variant" limittype="string int"/>
            <value type="int">0</value>
    </param>

    <param type="string" name="stokes">
            <description>stokes or correlation name (e.g. "I", "XX")</description>
            <value></value>
    </param>

    <param type="string" name ="gridfunction">
            <description>gridding function for imaging ("BOX","SF","PB")</description>
            <value>BOX</value>
            <allowed kind="enum">
                <value>BOX</value>
                <value>PB</value>
                <value>SF</value>
            </allowed>
    </param>
   
    <param type="string" name="imagename">
	    <description>output image name</description>
	    <value></value>
    </param>

    <param type="bool" name="overwrite">
            <description>overwrite option</description>
            <value>False</value>
    </param>

    <param type="intArray" name="imsize">
            <description>x and y image size in pixels, symmetric for single value</description>
            <value type="vector">
    <value>256</value><value>256</value>
            </value>
    </param>

    <param type="doubleArray" name="cell" units="arcmin">
    <description>x and y cell size. default unit arcmin</description>
    <value type="vector"><value>1.0</value><value>1.0</value></value>
    </param>

    <param type="bool" name="dochannelmap">
            <description>True for channel map, False for total power imaging</description>
            <value>False</value> 
    </param>

    <param type="int" name="nchan" subparam="true">
            <description>number of spectral channel for created image</description>
            <value>1</value>
    </param>

    <param type="double" name="start" subparam="true">
            <description>reference value of start channel (in units of specunit)</description>
            <value>0</value>
    </param>

    <param type="double" name="step" subparam="true">
            <description>width of each spectral channel (in units of specunit)</description>
            <value>1</value>
    </param>

    <param type="any" name="phasecenter">
            <description>Image phase center: position or field index</description>
            <any type="variant"/>
            <value type="string"></value>
    </param>

    <param type="string" name="ephemsrcname">
	    <description>ephemeris source name</description>
	    <value></value>
    </param>

    <param type="string" name="pointingcolumn">
            <description>pointing data column to use</description>
            <value>direction</value>
            <allowed kind="enum" ignorecase="True">
                <value>target</value>
                <value>pointing_offset</value>
                <value>source_offset</value>
                <value>encoder</value>
                <value>direction</value>
            </allowed>
    </param>

    <constraints>
            <when param="specunit">
                <equals type="string" value=""/>
                <equals type="string" value="channel"/>
                <equals type="string" value="GHz"/>
                <equals type="string" value="MHz"/>
                <equals type="string" value="kHz"/>
                <equals type="string" value="Hz"/>
                <equals type="string" value="km/s">
                    <default param="restfreq"><value type="string"></value></default>
                </equals>
            </when>
            <when param="dochannelmap">
                <equals type="bool" value="False"/>
                <equals type="bool" value="True">
                    <default param="nchan"><value type="int">1</value></default>
                    <default param="start"><value type="double">0</value></default>
                    <default param="step"><value type="double">1</value></default>
                </equals>
            </when>   
    </constraints>
  </input>

  <returns type="void"/>

  <example>
  Keyword arguments:
        sdfile -- name of input SD (MS) dataset
        specunit -- units for spectral axis
                options: (str) 'channel','km/s','GHz','MHz','kHz','Hz'
                default: 'channel'
                example: this will be the units for nchan, start, and step
  &gt;&gt;&gt; specunit='km/s' expandable parameters
               restfreq -- rest frequency
                 default: '' (refer input data)
                 example: 1.0e11, '100GHz'
        scanlist -- list of scan numbers to process
                default: [] (use all scans)
                example: [21,22,23,24]
                         this selection is in addition to field and spw
        field -- field id or selection string for selecting scans by name
                default: 0
                example: 'FLS3a', 0
                         this selection is in addition to scanlist and spw
        spw -- spectral window id
                default: 0
                example: 1
                         this selection is in addition to scanlist and field
        antenna -- select data based on antenna name(s) or id(s)
                default: 0
                example: '0', 'DV01'
        stokes -- select data based on stokes or polarization type 
                default: '' (use all polarizations)
                example: 'XX'
        gridfunction -- gridding function for imaging
                options: 'BOX' (Box-car), 'SF' (Spheroidal), 'PB' (Primary-beam)
                default: 'BOX'
                example: 'SF'
        imagename -- output image name
                default: none
                example: 'mySDimage.im'
        overwrite -- overwrite option for imagename
                default: False (not overwrite)
                options: True, False
                example: if True, existing file will be overwritten
        imsize -- x and y image size in pixels, symmetric for single value
                default: [256,256]
                example: imsize=200 (equivalent to [200,200])
        cell -- x and y cell size. default unit arcmin
                default: ['1.0arcmin', '1.0arcmin']
                example: cell=['0.2arcmin, 0.2arcmin']
                         cell='0.2arcmin' (equivalent to example above)
        dochannelmap -- channel map image or total power image
                default: False (total power)
                options: True (channel map), False
  &gt;&gt;&gt; dochannelmap=True expandable parameters
               nchan -- number of spectral channel for created image
                   default: 1 
                   example: to do total power imaging, set -1 
               start -- reference value of start channel (in units of specunit)
                   default: 0 (0th channel if specunit='channel')
                   example: 100
               step -- width of each spectral channel for created image
                   default: 1 (channel width of 1 channel if specunit='channel')
                   aexample: 100
        phasecenter -- image phase center: direction measure or fieldid 
                default: 0
                example: 'J2000 13h44m00 -17d02m00', 'AZEL -123d48m29 15d41m41'
        ephemsrcname -- ephemeris source name for moving source
                default: ''
                if the source name in the data matches one of the known 
                solar objects by the system, this task automatically set 
                the source name. 
                example: 'moon' 
        pointingcolumn -- pointing data column to use
                option: 'direction', 'target', 'pointing_offset', 'source_offset', 'encoder' 
                default: 'direction'


        DESCRIPTION:

        Task sdimaging create image from input single-dish data.
        The input can be either total power and spectral data. Currently,
        this task directly accesses the Measurement Set data only because of 
        the data access efficiency. So it differs from other single-dish tasks 
        that mostly operate on the ASAP scantable data format.
 
        Units of spectral axis can be specified via a parameter specunit.
        Allowed values for specunit are 'channel', 'GHz', 'MHz', 'kHz', 'Hz', 
        and 'km/s'. This parameter is also used as the units of the parameter 
        start and step that specify reference value of start channel and width 
        of each spectral channel for channel map, respectively.

        Selection of the antennas can be made by setting antennaid(s) or 
        antenna name(s) in string (e.g. '0', 'DV01',etc.). Note that the task 
        doesn't work for multiple antenna selection and/or multiple field 
        selection. 

        The parameter gridfunction sets gridding function for imaging. 
        Currently, the task supports 'BOX' (Box-car), 'SF' (Prolate Spheroidal 
        Wave Function), and 'PB' (Primary Beam). For 'PB', correct antenna 
        informations should be included in input file. 
  </example>

</task>

</casaxml>
