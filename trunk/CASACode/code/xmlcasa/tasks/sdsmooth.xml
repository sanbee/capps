<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">


<!-- This is the param set for sdsmooth -->

<task type="function" name="sdsmooth" startup="false" category="single dish">

  <shortdescription>ASAP SD task: do smoothing of spectra</shortdescription>

  <description>ASAP SD calibration task (based on the ALMATST5 recommendations):
        Do smoothing of spectra

        Task Version 2008-01-27 TT
        split and modified from Task Version 2007-03-04 STM
</description>

  <input>

    <param type="string" name="sdfile"  mustexist="true">
    <description>name of input SD dataset</description>
    <value></value>
    </param>

    <param type="any" name="antenna">
            <description>antenna name or id (only effective for MS input)</description>
            <any type="variant" limittype="string int"/>
            <value type="int">0</value>
    </param> 

    <param type="bool" name="scanaverage">
            <description>average integs within scans (True,False) </description>
            <value>False</value>
    </param>

    <param type="intArray" name="scanlist">
	    <description>list of scans to use (e.g. [1,2,3,4])</description>
	    <value></value>
    </param>

    <param type="string" name="field">
	    <description>string for selection by source name</description>
	    <value></value>
    </param>

    <param type="intArray" name="iflist">
	    <description>list of IF ids to select (e.g. [0,1])</description>
	    <value></value>
    </param>

    <param type="intArray" name="pollist">
	    <description>list of polarization ids to select (e.g. [0,1])</description>
	    <value></value>
    </param>

    <param type="string" name="kernel">
            <description>type of spectral smoothing</description>
	    <value>hanning</value>
	    <allowed kind="enum">
	    <value>hanning</value>
	    <value>gaussian</value>
	    <value>boxcar</value>
            </allowed>
    </param>

    <param type="int" name="kwidth" subparam="true">
	    <description>width of spectral kernel in channels</description>
	    <value>5</value>
    </param>

    <param type="bool" name="verify">
            <description>verify the results of smoothing</description>
            <value>False</value>
    </param>

    <param type="string" name="outfile">
	    <description>output file name</description>
	    <value></value>
    </param>

    <param type="string" name="outform">
	    <description>output file format (ASCII,MS,SDFITS,ASAP)</description>
	    <value>ASAP</value>
	    <allowed kind="enum">
	    <value>ASCII</value>
	    <value>ascii</value>
	    <value>MS</value>
	    <value>ms</value>
	    <value>MS2</value>
	    <value>ms2</value>
	    <value>SDFITS</value>
	    <value>sdfits</value>
	    <value>ASAP</value>
	    <value>asap</value>
	    </allowed>
    </param>
    <param type="bool" name="overwrite">
            <description>overwrite the output file if already exists</description>
            <value>False</value>
    </param>



    <param type="int" name="plotlevel">
	    <description>plot results (0=none,1+=some,&lt;0=hardcopy)</description>
	    <value>0</value>
    </param>

    <constraints>
	    <when param="kernel">
		<equals value="hanning"/>
		<equals value="gaussian">
			<default param="kwidth"><value>5</value></default>
		</equals>
		<equals value="boxcar">
			<default param="kwidth"><value>5</value></default>
		</equals>
	    </when>
    </constraints>

    </input>

  <returns type="void"/>

  <example>

	Keyword arguments:
        sdfile -- name of input SD dataset
        antenna -- antenna name or id (only effective for MS input). 
        scanaverage -- average integrations within scans
                options: (bool) True,False
                default: False
                example: if True, this happens in read-in
                         For GBT, set False!
        scanlist -- list of scan numbers to process
                default: [] (use all scans)
                example: [21,22,23,24]
                         this selection is in addition to field,
                         iflist, and pollist
        field -- selection string for selecting scans by name
                default: '' (no name selection)
                example: 'FLS3a*'
                         this selection is in addition to scanlist,
                         iflist,pollist
        iflist -- list of IF id numbers to select
                default: [] (use all IFs)
                example: [15]
                this selection is in addition to scanlist,
                         field, and pollist
        pollist -- list of polarization id numbers to select
                default: [] (use all polarizations)
                example: [1]
                this selection is in addition to scanlist,
                field, and iflist
	kernel -- type of spectral smoothing
	        options: 'hanning','gaussian','boxcar'
	        default: 'hanning'

            &gt;&gt;&gt;kernel expandable parameter
                 kwidth -- width of spectral smoothing kernel
	                 options: (int) in channels 
	                 default: 5
		         example: 5 or 10 seem to be popular for boxcar
		                  ignored for hanning (fixed at 5 chans)
                                  (0 will turn off gaussian or boxcar)

        verify -- verify the results of smoothing
                options: (bool) True,False
                default: False
                WARNING: Currently this just asks whether you accept
                         the displayed smoothing and if not, continues
                         without smoothing.
	outfile -- Name of output ASAP format(scantable) file
	        default: '' (&lt;sdfile&gt;_sm)
	outform -- format of output file
                options: 'ASCII','SDFITS','MS','ASAP'
                default: 'ASAP'
                example: the ASAP format is easiest for further sd
                         processing; use MS for CASA imaging.
                         If ASCII, then will append some stuff to
                         the outfile name
        overwrite -- overwrite the output file if already exists
                options: (bool) True,False
                default: False
                WARNING: if outform='ASCII', this parameter is ignored
        plotlevel -- control for plotting of results
	        options: (int) 0=none, 1=some, 2=more, &lt;0=hardcopy
		default: 0 (no plotting)
		example: plotlevel&lt;0 as abs(plotlevel), e.g.
		         -1 =&gt; hardcopy of final plot (will be named
		         &lt;outfile&gt;_smspec.eps)


        DESCRIPTION:

	Task sdsmooth performs smoothing of the single-dish spectra.
        Set plotlevel &gt;= 1 to plot spectrum before and after smoothing.

        WARNING for the GBT raw SDFITS format data as input:
        Currently, all SDtasks cannot handle GBT raw SDFITS format data
        (in which the data are stored in multiple tables within SDFITS).
        It may be still possible to reduce GBT data after some
        preprocessing (outside CASA) of the raw SDFITS to a SDFITS with
        a single data table or to other data formats handled by SDtasks.


  </example>

</task>

</casaxml>
